"use strict";(self.webpackChunksclab_docs=self.webpackChunksclab_docs||[]).push([[7957],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>h});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var s=n.createContext({}),u=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},d=function(e){var t=u(e.components);return n.createElement(s.Provider,{value:t},e.children)},p="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),p=u(a),m=i,h=p["".concat(s,".").concat(m)]||p[m]||c[m]||r;return a?n.createElement(h,l(l({ref:t},d),{},{components:a})):n.createElement(h,l({ref:t},d))}));function h(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,l=new Array(r);l[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[p]="string"==typeof e?e:i,l[1]=o;for(var u=2;u<r;u++)l[u]=a[u];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},7906:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>c,frontMatter:()=>r,metadata:()=>o,toc:()=>u});var n=a(7462),i=(a(7294),a(3905));const r={title:"ODBC Connector",tags:["Connector","DB","ODBC"]},l=void 0,o={unversionedId:"tutorial/Connectors/ODBC",id:"tutorial/Connectors/ODBC",title:"ODBC Connector",description:"Introduction",source:"@site/docs/tutorial/02-Connectors/05-ODBC.md",sourceDirName:"tutorial/02-Connectors",slug:"/tutorial/Connectors/ODBC",permalink:"/docs/tutorial/Connectors/ODBC",draft:!1,editUrl:"https://github.com/sclab-io/sclab-io.github.io/tree/main/docs/tutorial/02-Connectors/05-ODBC.md",tags:[{label:"Connector",permalink:"/docs/tags/connector"},{label:"DB",permalink:"/docs/tags/db"},{label:"ODBC",permalink:"/docs/tags/odbc"}],version:"current",sidebarPosition:5,frontMatter:{title:"ODBC Connector",tags:["Connector","DB","ODBC"]},sidebar:"tutorial",previous:{title:"SQL Server Connector",permalink:"/docs/tutorial/Connectors/MSSQL"}},s={},u=[{value:"Introduction",id:"introduction",level:2},{value:"Features",id:"features",level:2},{value:"mqtt method format:",id:"mqtt-method-format",level:3},{value:"api method format:",id:"api-method-format",level:3},{value:"Installation",id:"installation",level:2},{value:"Requirements",id:"requirements",level:3},{value:"Sample /etc/odbcinst.ini",id:"sample-etcodbcinstini",level:3},{value:"Sample ~/.odbc.ini",id:"sample-odbcini",level:3},{value:"Node.js Version Support",id:"nodejs-version-support",level:3},{value:"install nodejs 14",id:"install-nodejs-14",level:3},{value:"clone source",id:"clone-source",level:3},{value:"create JWT key file for API",id:"create-jwt-key-file-for-api",level:3},{value:"create .env.production.local",id:"create-envproductionlocal",level:3},{value:"start",id:"start",level:3},{value:"stop",id:"stop",level:3},{value:"logs",id:"logs",level:3},{value:"access API end point",id:"access-api-end-point",level:3},{value:"Build source",id:"build-source",level:2},{value:"build source",id:"build-source-1",level:3},{value:"Connect data using API",id:"connect-data-using-api",level:2},{value:"Connect to QUERY_2",id:"connect-to-query_2",level:3},{value:"1. Navigate to the data editor screen in SCLAB Studio and add an API.",id:"1-navigate-to-the-data-editor-screen-in-sclab-studio-and-add-an-api",level:3},{value:"2. Select the Headers tab and enter the authentication key value.",id:"2-select-the-headers-tab-and-enter-the-authentication-key-value",level:3},{value:"3. If it is a query with parameters set, add the setting value to the Params tab.",id:"3-if-it-is-a-query-with-parameters-set-add-the-setting-value-to-the-params-tab",level:3},{value:"4. Click the SEND button to establish a connection.",id:"4-click-the-send-button-to-establish-a-connection",level:3},{value:"5. Verify that the data is coming in properly.",id:"5-verify-that-the-data-is-coming-in-properly",level:3},{value:"6. If the data is received, map the field and label values through the Pass Configuration.",id:"6-if-the-data-is-received-map-the-field-and-label-values-through-the-pass-configuration",level:3},{value:"7. Click the SAVE button to save the data.",id:"7-click-the-save-button-to-save-the-data",level:3},{value:"8. Then, proceed to visualize the data in chart or table format.",id:"8-then-proceed-to-visualize-the-data-in-chart-or-table-format",level:3},{value:"Mapping with Mybatis",id:"mapping-with-mybatis",level:2},{value:"Example of using if statement",id:"example-of-using-if-statement",level:3},{value:"Example of using a date range query",id:"example-of-using-a-date-range-query",level:3},{value:"How to troubleshoot issues related to gcc",id:"how-to-troubleshoot-issues-related-to-gcc",level:3},{value:"CentOS 7 - 64bit",id:"centos-7---64bit",level:4}],d={toc:u},p="wrapper";function c(e){let{components:t,...a}=e;return(0,i.kt)(p,(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"introduction"},"Introduction"),(0,i.kt)("p",null,"This connector provides functionality for retrieving data using ODBC in SCLAB Studio."),(0,i.kt)("h2",{id:"features"},"Features"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Connect to Database using unixODBC"),(0,i.kt)("li",{parentName:"ul"},"MQTT message publish using SQL Query with interval"),(0,i.kt)("li",{parentName:"ul"},"Create REST API endpoint with SQL Query"),(0,i.kt)("li",{parentName:"ul"},"JWT for HTTP authorization"),(0,i.kt)("li",{parentName:"ul"},"Processing of result data into JSON format"),(0,i.kt)("li",{parentName:"ul"},"SQL Injection filter (default on)"),(0,i.kt)("li",{parentName:"ul"},"Mapping with Mybatis")),(0,i.kt)("p",null,'By adding a query in the format of "QUERY_1=mqtt;query;topic;interval ms" to the .env file, SQL is automatically executed to connect and retrieve data from SCLAB.'),(0,i.kt)("p",null,"Two methods are supported: MQTT and API, each with a different variable format:"),(0,i.kt)("h3",{id:"mqtt-method-format"},"mqtt method format:"),(0,i.kt)("p",null,"QUERY_#=mqtt;SQL Query;topic;interval MS"),(0,i.kt)("h3",{id:"api-method-format"},"api method format:"),(0,i.kt)("p",null,"QUERY_#=api;SQL Query;Endpoint URL"),(0,i.kt)("h2",{id:"installation"},"Installation"),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"requirements"},"Requirements"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"install nodejs"),(0,i.kt)("li",{parentName:"ul"},"unixODBC binaries and development libraries for module compilation",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"on Ubuntu/Debian ",(0,i.kt)("inlineCode",{parentName:"li"},"sudo apt-get install unixodbc unixodbc-dev")),(0,i.kt)("li",{parentName:"ul"},"on RedHat/CentOS ",(0,i.kt)("inlineCode",{parentName:"li"},"sudo yum install unixODBC unixODBC-devel")),(0,i.kt)("li",{parentName:"ul"},"on OSX",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"using macports.org ",(0,i.kt)("inlineCode",{parentName:"li"},"sudo port unixODBC")),(0,i.kt)("li",{parentName:"ul"},"using brew ",(0,i.kt)("inlineCode",{parentName:"li"},"brew install unixODBC")))),(0,i.kt)("li",{parentName:"ul"},"on FreeBSD from ports ",(0,i.kt)("inlineCode",{parentName:"li"},"cd /usr/ports/databases/unixODBC; make install")),(0,i.kt)("li",{parentName:"ul"},"on IBM i ",(0,i.kt)("inlineCode",{parentName:"li"},"yum install unixODBC unixODBC-devel")," (requires ",(0,i.kt)("a",{parentName:"li",href:"http://ibm.biz/ibmi-rpms"},"yum"),")"))),(0,i.kt)("li",{parentName:"ul"},"ODBC drivers for target database"),(0,i.kt)("li",{parentName:"ul"},"properly configured odbc.ini and odbcinst.ini."),(0,i.kt)("li",{parentName:"ul"},"print config info ",(0,i.kt)("inlineCode",{parentName:"li"},"odbcinst -j")),(0,i.kt)("li",{parentName:"ul"},"test dsn ",(0,i.kt)("inlineCode",{parentName:"li"},"isql -v mydsn myusername mypassword"))),(0,i.kt)("h3",{id:"sample-etcodbcinstini"},"Sample /etc/odbcinst.ini"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"[PostgreSQL]\nDescription     = ODBC for PostgreSQL\nDriver          = /usr/lib/psqlodbcw.so\nSetup           = /usr/lib/libodbcpsqlS.so\nDriver64        = /usr/lib64/psqlodbcw.so\nSetup64         = /usr/lib64/libodbcpsqlS.so\nFileUsage       = 1\n\n[MySQL]\nDescription     = ODBC for MySQL\nDriver          = /usr/lib/libmyodbc5.so\nSetup           = /usr/lib/libodbcmyS.so\nDriver64        = /usr/lib64/libmyodbc5.so\nSetup64         = /usr/lib64/libodbcmyS.so\nFileUsage       = 1\n\n[Tibero]\nDescription = ODBC for Tibero\nDriver = /home/tibero/tibero7/client/lib/libtbodbc.so\nSetup = /home/tibero/tibero7/client/lib/libtbodbc.so\nSetup = 1\nFileUsage = 1\n")),(0,i.kt)("h3",{id:"sample-odbcini"},"Sample ~/.odbc.ini"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"[ODBC Data Sources]\nMyDB = MySQL\nMyTB = Tibero 7\n\n[ODBC]\nTrace = yes\nTraceFile = /home/odbc.log\n\n[MyDB]\nDriver = MySQL\nserver = 127.0.0.1\nport = 3306\nuser = myuser\ndatabase = mydb\npassword = password\n\n[MyTB]\ndriver = Tibero\nserver = 127.0.0.1\nport = 8629\nSID = tibero\nuser = sys\npassword = tibero\nDatabase = tibero\n")),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"nodejs-version-support"},"Node.js Version Support"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Node.js 12"),(0,i.kt)("li",{parentName:"ul"},"Node.js 14"),(0,i.kt)("li",{parentName:"ul"},"Node.js 16"),(0,i.kt)("li",{parentName:"ul"},"Node.js 18")),(0,i.kt)("h3",{id:"install-nodejs-14"},"install nodejs 14"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"curl -sL https://rpm.nodesource.com/setup_14.x | sudo bash -\nsudo yum install nodejs\n")),(0,i.kt)("h3",{id:"clone-source"},"clone source"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ git clone https://github.com/sclab-io/sclab-odbc-connector-node\n")),(0,i.kt)("h3",{id:"create-jwt-key-file-for-api"},"create JWT key file for API"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ mkdir jwt\n$ ssh-keygen -t rsa -b 4096 -m PEM -f ./jwt/jwtRS256.key\n# empty passphrase - just press enter\n$ openssl rsa -in ./jwt/jwtRS256.key -pubout -outform PEM -out ./jwt/jwtRS256.key.pub\n")),(0,i.kt)("h3",{id:"create-envproductionlocal"},"create .env.production.local"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'$ vi .env.production.local\n\n# ODBC Connection string\nCONNECTION_STRING="DSN=MyDB"\nMAX_POOL_SIZE=5\n\n# SCLAB IoT (Remove this environment if you do not need to use MQTT)\n# MQTT_TOPIC=yourtopic/\n# MQTT_HOST=yourhost\n# MQTT_CLIENT_ID=your-client-id/1\n# MQTT_ID=your-id\n# MQTT_PASSWORD=your-password\n\n# QUERY_#=mqtt;query;topic;interval ms\n# QUERY_#=api;query;endPoint\nQUERY_1=api;SELECT ROUND( RAND() * 100 ) AS value, NOW() AS datetime;/api/1\nQUERY_2=api;SELECT ${field} from ${table} where name="${name}";/api/2\n# QUERY_3=mqtt;SELECT ROUND( RAND() * 100 ) AS value, NOW() AS datetime;test0;1000\n# QUERY_4=mqtt;SELECT ROUND( RAND() * 1000 ) AS value, NOW() AS datetime;test1;5000\n# QUERY_mybatis_1=mybatis;sample;test;/api/mybatistest\n\n# PORT\nPORT=3000\n\n# MyBatis\nMY_BATIS_FILE_FOLDER=./mybatis\n\n# TOKEN\nSECRET_KEY=secretKey\nJWT_PRIVATE_KEY_PATH=./jwt/jwtRS256.key\nJWT_PUBLIC_KEY_PATH=./jwt/jwtRS256.key.pub\n\n# LOG\nLOG_FORMAT=combined\nLOG_DIR=../logs\n\n# CORS\nORIGIN=your.domain.com\nCREDENTIALS=true\n\n# SQL INJECTION\nSQL_INJECTION=1\n')),(0,i.kt)("h3",{id:"start"},"start"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# nodejs\n$ npm run start\n\n# pm2\n$ npm run deploy:prod\n")),(0,i.kt)("h3",{id:"stop"},"stop"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# pm2\n$ ./stop.sh\n")),(0,i.kt)("h3",{id:"logs"},"logs"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ ./logs.sh\n")),(0,i.kt)("h3",{id:"access-api-end-point"},"access API end point"),(0,i.kt)("p",null,"To access the API, you need to include authorization information in the Request Header in the following format:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"authorization: yourkey\n")),(0,i.kt)("p",null,"You can find your key information through the logs."),(0,i.kt)("h2",{id:"build-source"},"Build source"),(0,i.kt)("h3",{id:"build-source-1"},"build source"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ npm install\n$ npm run build\n")),(0,i.kt)("h2",{id:"connect-data-using-api"},"Connect data using API"),(0,i.kt)("h3",{id:"connect-to-query_2"},"Connect to QUERY_2"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'QUERY_2=api;SELECT ${field} from ${table} where name="${name}";/api/2\n')),(0,i.kt)("h3",{id:"1-navigate-to-the-data-editor-screen-in-sclab-studio-and-add-an-api"},"1. Navigate to the data editor screen in SCLAB Studio and add an API."),(0,i.kt)("p",null,"Enter the API endpoint address you want to connect to. If you are using Docker, the default port is set to 9180."),(0,i.kt)("p",null,"Please enter the address in the following format."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"http://ip:9180/api/2\n")),(0,i.kt)("h3",{id:"2-select-the-headers-tab-and-enter-the-authentication-key-value"},"2. Select the Headers tab and enter the authentication key value."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Key"),(0,i.kt)("th",{parentName:"tr",align:null},"Value Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Value"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"authorization"),(0,i.kt)("td",{parentName:"tr",align:null},"Fixed"),(0,i.kt)("td",{parentName:"tr",align:null},"yourkeyfromlog")))),(0,i.kt)("h3",{id:"3-if-it-is-a-query-with-parameters-set-add-the-setting-value-to-the-params-tab"},"3. If it is a query with parameters set, add the setting value to the Params tab."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Key"),(0,i.kt)("th",{parentName:"tr",align:null},"Value Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Value"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"field"),(0,i.kt)("td",{parentName:"tr",align:null},"Variable"),(0,i.kt)("td",{parentName:"tr",align:null},"*")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"table"),(0,i.kt)("td",{parentName:"tr",align:null},"Variable"),(0,i.kt)("td",{parentName:"tr",align:null},"product")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"name"),(0,i.kt)("td",{parentName:"tr",align:null},"Variable"),(0,i.kt)("td",{parentName:"tr",align:null},"Bike")))),(0,i.kt)("h3",{id:"4-click-the-send-button-to-establish-a-connection"},"4. Click the SEND button to establish a connection."),(0,i.kt)("h3",{id:"5-verify-that-the-data-is-coming-in-properly"},"5. Verify that the data is coming in properly."),(0,i.kt)("h3",{id:"6-if-the-data-is-received-map-the-field-and-label-values-through-the-pass-configuration"},"6. If the data is received, map the field and label values through the Pass Configuration."),(0,i.kt)("h3",{id:"7-click-the-save-button-to-save-the-data"},"7. Click the SAVE button to save the data."),(0,i.kt)("h3",{id:"8-then-proceed-to-visualize-the-data-in-chart-or-table-format"},"8. Then, proceed to visualize the data in chart or table format."),(0,i.kt)("h2",{id:"mapping-with-mybatis"},"Mapping with Mybatis"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Mybatis utilizes ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/OldBlackJoe/mybatis-mapper/tree/master"},"https://github.com/OldBlackJoe/mybatis-mapper/tree/master"),", and only the supported formats from there are applicable."),(0,i.kt)("li",{parentName:"ul"},"To use it, please create a mybatis folder.")),(0,i.kt)("h3",{id:"example-of-using-if-statement"},"Example of using if statement"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"You can input the following format in the mybatis folder.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="./mybatis/sample.xml"',title:'"./mybatis/sample.xml"'},'<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n<mapper namespace="sample">  \n  <select id="test">\n    SELECT\n      *\n    FROM\n      resume\n    WHERE\n      1=1\n      <if test="id != null and id != \'\'">\n      AND id = ${id}\n      </if>\n    \n    <if test="limit != null and limit != \'\'">\n      LIMIT ${limit}\n    </if>\n  </select>\n</mapper>\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The above example uses an if statement to search by the id condition only if the id value is passed as a parameter. Otherwise, it returns all the data."),(0,i.kt)("li",{parentName:"ul"},"After adding the XML file, add the configuration to the environment variable as follows:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title=".env.production.local"',title:'".env.production.local"'},"QUERY_mybatis_1=mybatis;sample;test;/api/mybatistest\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"After adding the environment variable, restart the system. Once restarted, when making a request to the corresponding endpoint, it will be connected to sample.test in the mybatis folder, allowing you to create queries and retrieve data.")),(0,i.kt)("h3",{id:"example-of-using-a-date-range-query"},"Example of using a date range query"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="./mybatis/sample2.xml"',title:'"./mybatis/sample2.xml"'},"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\">\n<mapper namespace=\"sample2\">  \n  <select id=\"test\">\n    SELECT \n      DATE_FORMAT(date_parse(date, '%Y%m%d'), '%Y') AS year, \n      DATE_FORMAT(date_parse(date, '%Y%m%d'), '%m') AS month, \n      SUM(newusercount) AS total_new_user_count \n    FROM mycatalog.mydb.statistics \n    WHERE \n      date_parse(date, '%Y%m%d') BETWEEN \n      date_parse(${startDate}, '%Y%m%d') AND \n      date_parse(${endDate}, '%Y%m%d') \n    GROUP BY \n      DATE_FORMAT(date_parse(date, '%Y%m%d'), '%Y'), \n      DATE_FORMAT(date_parse(date, '%Y%m%d'), '%m') \n    ORDER BY year, month\n  </select>\n</mapper>\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The above query retrieves the number of new members who joined during a specific period from a statistics table."),(0,i.kt)("li",{parentName:"ul"},"The data in the table is stored with the format 'YYYYMMDD' for the date."),(0,i.kt)("li",{parentName:"ul"},"To extract data on a monthly basis, the query calculates the new member count for each month."),(0,i.kt)("li",{parentName:"ul"},"Since only daily data is stored, it uses SUM to calculate the total, and GROUP BY retrieves the data in the format of year and month.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title=".env.production.local"',title:'".env.production.local"'},"QUERY_mybatis_2=mybatis;sample2;test;/api/mybatistest2\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"After adding the environment variable, restart the system.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"curl \"http://localhost:9180/api/mybatistest2?startDate=20200101&endDate=20231223\" -H 'authorization: TOKEN'\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"By making a request like the above, you can retrieve the number of new members who joined on a monthly basis from January 2023 to June 2023.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "rows":[\n    {"year":"2023","month":"01","total_new_user_count":3567},\n    {"year":"2023","month":"02","total_new_user_count":3416},\n    {"year":"2023","month":"03","total_new_user_count":4345},\n    {"year":"2023","month":"04","total_new_user_count":4025},\n    {"year":"2023","month":"05","total_new_user_count":4488},\n    {"year":"2023","month":"06","total_new_user_count":4453}\n  ]\n}\u23ce\n')),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"how-to-troubleshoot-issues-related-to-gcc"},"How to troubleshoot issues related to gcc"),(0,i.kt)("p",null,"The gcc library is required to connect with unixODBC, but errors may occur occasionally on older operating systems.\nBelow are the solutions for this."),(0,i.kt)("h4",{id:"centos-7---64bit"},"CentOS 7 - 64bit"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"/lib64/libstdc++.so.6: version `CXXABI_1.3.9' not found")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"# check libstdc++\n# if 1.3.9 is absent upgrade libstdc++\nstrings /lib64/libstdc++.so.6 | grep CXXABI\n\n# centos7 upgrade process\ncd gcc\n\n# use prebuild lib if this doesn't work you have to build gcc\n./centos7_setup_gcc9.2.0.sh\n\n# check again\nstrings /lib64/libstdc++.so.6 | grep CXXABI\n\n# restart\ncd ..\n./stop.sh\n./run.sh\n\n# if connector has no error, you don't have to run this script\n# or build lib (you can change gcc version in ./centos7_build_gcc9.2.0.sh file's GCC_VERSION=9.2.0)\n./centos7_build_gcc9.2.0.sh\n")))}c.isMDXComponent=!0}}]);